# Cypress Pentesting Plugin

Cypress plugin for penetration testing web applications. This plugin offers a multitude of functions
to test for security flaws in your web application. The focus in this version is on injection attacks,
more features will be added in the future. 
******
THIS PLUGIN IS JUST A PROTOTYPE AND NOT READY FOR PRODUCTION USE.
******
## Installation
Install the plugin via npm:
```bash
npm install cypress-pentest-plugin
```
## Extend Cypress Commands
In order to use the plugin functions in Cypress, you have to do the following:
```js
export default defineConfig({
    e2e: {
        setupNodeEvents(on, config) {
            const version = config.env.VERSION || 'local';
            const urls = {
                local: "http://localhost:3000",
                dev: "https://dev.example.com",
                test: "https://test.example.com",
                stage: "https://stage.example.com",
                prod: "https://example.com"
            }
            config.baseUrl = urls[version];
            // configure plugins here.
            // Task event listener triggers function calls.
            on('task', {
                checkEndpoint({ request, injectable }) {
                    return checkEndpoint(request, injectable);
                },
                sqlMap({ route, args }) {
                    return sqlMap(route, args);
                },
                headerSQLi({request, headers}) {
                    return headerSQLi({request, headers});
                },
                reflectedXSS({request}) {
                    return reflectedXSS(request);
                },
                csrf({request}) {
                    return csrf(request);
                }
            });
            return config;
        },

    }
})
```

This plugin extends Cypress commands with the following:
- `cy.sqlMap(): Use sqlmap to test for SQL injection vulnerabilities`
- `cy.checkEndpoint(): Check if an endpoint is vulnerable to SQL injection`
- `cy.reflectedXSS(): Check if an endpoint is vulnerable to reflected XSS`

And many more to come!
## Usage
In your Tests, you can use the functions just like any other Cypress function.
You just have to intercept the request. See the example test cases in the cypress folder.

## Roadmap
