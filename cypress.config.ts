import { defineConfig } from 'cypress';
import { checkEndpoint, sqlMap, secondOrderAttack, headerSQLi, spawnShell, reflectedXSS } from "./src/index.ts";

export default defineConfig({
    e2e: {
        setupNodeEvents(on, config) {
            const version = config.env.VERSION || 'local';
            const urls = {
                local: "http://localhost:3000",
                dev: "https://ch1-eflex-b2c.dev.efd.hr/",
                test: "https://test.example.com",
                stage: "https://stage.example.com",
                prod: "https://example.com"
            }
            config.baseUrl = urls[version];
            // configure plugins here.
            // Task event listener triggers function calls.
            on('task', {
                checkEndpoint({ request, injectable }) {
                    return checkEndpoint(request, injectable);
                }
            });
            on('task', {
                sqlMap({ route, args }) {
                    return sqlMap(route, args);
                }
            });
            on('task', {
                headerSQLi({request, headers}) {
                    return headerSQLi({request, headers});
                }
            });
            on('task', {
                reflectedXSS(request) {
                    return reflectedXSS(request);
                }
            });
            return config;
        },
        // baseUrl: 'http://localhost:3000',

    }
})