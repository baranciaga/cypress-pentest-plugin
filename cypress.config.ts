import { defineConfig } from 'cypress';
import { checkEndpoint, sqlMap, secondOrderAttack, headerSQLi, spawnShell, reflectedXSS } from "./src/index.ts";

export default defineConfig({
    e2e: {
        setupNodeEvents(on, config) {
            // configure plugins here.
            // Task event listener triggers function calls.
            on('task', {
                checkEndpoint({ request, method, endpoint, postParams }) {
                    return checkEndpoint(request, method, endpoint, postParams);
                }
            });
            on('task', {
                sqlMap({ route, args}) {
                    return sqlMap({route, args});
                }
            });
            on('task', {
                headerSQLi({request, headers}) {
                    return headerSQLi({request, headers});
                }
            });
            on('task', {
                reflectedXSS(request) {
                    return reflectedXSS(request);
                }
            });
            return config;
        },
        baseUrl: 'http://localhost:3000',
        env: {
            // set environment variables here
            key: 'value'
        },

    }
})