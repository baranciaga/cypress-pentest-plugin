import '../support/index';
/// <reference types="Cypress" />
describe('XSS Test Suite', () => {
    it('should test the app for CSRF possibilities',() => {
        cy.visit('/#/login') // #/form/new-
        cy.get('.close-dialog').click() // unnecessary?
        cy.get('#email').type("test@baran.com")
        cy.get('#password').type('baran2') // CHANGE HERE!!!
        cy.get('#loginButton').click()
        cy.intercept('GET', '/rest/user/change-password*').as('interceptedRequest');
        cy.visit('/#/privacy-security/change-password')
        cy.get('#currentPassword').type('baran2') // CHANGE HERE!!!
        cy.get('#newPassword').type('baran')
        cy.get('#newPasswordRepeat').type('baran')
        cy.get('#changeButton').click();
        cy.wait('@interceptedRequest').then((req) => {
            console.log('+++++++++++++++++++++++++++++')
            const query = {x:2, y:3};
            // TODO: cy.csrf(req, query);
            if(!cy.csrf(req)){
                throw new Error('CSRF detected');
            }
        })
    })
})